<!doctype html>
<html lang="nl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Codeblocks WebLab — Registreer</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800;900&display=swap" rel="stylesheet">
  <style>
    :root {
      --clr-bg: #070a19; --clr-bg-accent: #10152f; --clr-primary: #7355ff; --clr-primary-light: #a18bff;
      --clr-text: #e7e9f7; --clr-text-muted: #8a8fae; --radius: 1rem; --transition: 220ms ease;
    }
    *,*::before,*::after{margin:0;padding:0;box-sizing:border-box}
    body{font-family:Inter,system-ui,Arial;background:var(--clr-bg);color:var(--clr-text);line-height:1.6}
    a{color:inherit;text-decoration:none}
    .container{width:min(92%,1200px);margin-inline:auto}

    header.site-header{position:sticky;top:0;z-index:100;backdrop-filter:blur(6px);background:rgba(7,10,25,.6)}
    .header-container{display:flex;align-items:center;justify-content:space-between;padding-block:.5rem}
    .logo img{width:120px}
    nav ul{list-style:none;display:flex;gap:1.5rem;font-weight:500}
    nav a{transition:var(--transition)}
    nav a:hover{color:var(--clr-primary-light)}

    main{display:grid;place-items:center;min-height:calc(100dvh - 80px)}
    .card{width:min(500px, 92%);background:rgba(255,255,255,.04);border:1px solid rgba(255,255,255,.06);border-radius:var(--radius);padding:1.5rem}
    h1{font-size:1.8rem;margin:0 0 .75rem}
    .field{display:grid;gap:.4rem;margin:.7rem 0}
    .field label{font-size:.9rem;color:var(--clr-text-muted)}
    .field input{width:100%;padding:.9rem 1rem;border-radius:.8rem;border:1px solid #2a2f4a;background:#0a0f29;color:#e7e9f7}

    .btn{display:inline-flex;align-items:center;justify-content:center;font-weight:700;border-radius:var(--radius);padding:.8rem 1.1rem;font-size:1rem;transition:var(--transition)}
    .btn-primary{background:var(--clr-primary);color:#fff}
    .btn-primary:hover{background:var(--clr-primary-light)}

    .row{display:flex;gap:.8rem;align-items:center;flex-wrap:wrap}
    .hidden{display:none!important}
    footer{padding:2rem 0;text-align:center;color:var(--clr-text-muted)}
  </style>
</head>
<body>
  <header class="site-header">
    <div class="container header-container">
      <a class="logo" href="/"><img src="https://codeblocks.nl/cdn-homepage/logo-wit.png" alt="Codeblocks Logo"/></a>
      <nav class="main-nav">
        <ul>
          <li><a href="/download.html">Download instructie</a></li>
          <li><a href="/login.html">Login</a></li>
          <li><a href="/register.html" aria-current="page">Registreer</a></li>
          <li><a href="/contact.html">Contact</a></li>
          <li><a id="nav-dashboard" class="hidden" href="/dashboard.html">Dashboard</a></li>
          <li><a id="nav-logout" class="hidden" href="#">Uitloggen</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <main>
    <section class="card" aria-labelledby="reg-title">
      <h1 id="reg-title">Registreer</h1>
      <div class="field">
        <label for="re-name">Naam</label>
        <input id="re-name" type="text" placeholder="Jouw naam" />
      </div>
      <div class="field">
        <label for="re-email">E‑mail</label>
        <input id="re-email" type="email" placeholder="jij@school.nl" autocomplete="username" />
      </div>
      <div class="field">
        <label for="re-pass">Wachtwoord</label>
        <input id="re-pass" type="password" placeholder="min. 6 tekens" autocomplete="new-password" />
      </div>
      <div class="field">
        <label for="re-pass2">Bevestig wachtwoord</label>
        <input id="re-pass2" type="password" placeholder="Herhaal wachtwoord" autocomplete="new-password" />
      </div>
      <div class="row" style="margin-top:.5rem">
        <button id="btn-register-teacher" class="btn btn-primary">Registreer als docent</button>
        <span id="re-msg" class="muted" role="status"></span>
      </div>
      <p class="muted" style="margin-top:1rem;font-size:.95rem">Heb je al een account? <a href="/login.html" style="color:var(--clr-primary-light);text-decoration:underline">Login</a></p>
    </section>
  </main>

  <footer>© <span id="year"></span> weblab een software van codeblocks</footer>

  <!-- Firebase init -->
  <script type="module">
    import { initializeApp, getApps } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-app.js";
    import { getAuth, createUserWithEmailAndPassword, updateProfile } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-auth.js";
    import { getFirestore, doc, setDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/12.1.0/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyBtCy11XuUHG--v6SzH_zu56S0Ye07ZClA",
      authDomain: "weblab-3ccb8.firebaseapp.com",
      projectId: "weblab-3ccb8",
      storageBucket: "weblab-3ccb8.firebasestorage.app",
      messagingSenderId: "196123886547",
      appId: "1:196123886547:web:36aeaf014fdd481f9d6526"
    };

    const app = getApps().length ? getApps()[0] : initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    const $ = s=>document.querySelector(s);
    document.getElementById('year').textContent = new Date().getFullYear();

    $('#btn-register-teacher').addEventListener('click', async ()=>{
      const name = $('#re-name').value.trim();
      const email = $('#re-email').value.trim();
      const pass = $('#re-pass').value;
      const pass2 = $('#re-pass2').value;
      const msg = $('#re-msg'); msg.textContent = '';

      if(!name || !email || !pass || !pass2){ msg.textContent = 'Vul alle velden in'; return; }
      if(pass !== pass2){ msg.textContent = 'Wachtwoorden komen niet overeen'; return; }

      try{
        const cred = await createUserWithEmailAndPassword(auth, email, pass);
        await updateProfile(cred.user, { displayName: name });
        await setDoc(doc(db, 'users', cred.user.uid), {
          name,
          email,
          role: 'teacher',
          createdAt: serverTimestamp()
        });
        msg.textContent = 'Docentaccount aangemaakt. Doorsturen…';
        location.href = '/dashboard.html';
      }catch(e){
        const code = e?.code||'';
        if(code.includes('email-already-in-use')) msg.textContent = 'E‑mail is al in gebruik';
        else if(code.includes('invalid-email')) msg.textContent = 'E‑mail is ongeldig';
        else if(code.includes('weak-password')) msg.textContent = 'Wachtwoord te zwak (min. 6 tekens)';
        else msg.textContent = 'Er ging iets mis';
      }
    });
  </script>
</body>
</html>
